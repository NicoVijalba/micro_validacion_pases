# ADR 0002: JWT con Emision Local por Usuario/Password

## Status
Accepted - 2026-02-09

## Context
Se requiere que el mismo microservicio emita token desde un endpoint con usuario/password y luego valide Bearer token para proteger `POST /v1/records`.

## Decision
- Endpoint `POST /v1/token` para emitir JWT.
- Modo principal: `HS256` con secreto en entorno (`JWT_HS_SECRET`).
- Usuarios credenciales en `TOKEN_USERS` (secret manager en produccion).
- Validacion de claims: `iss`, `aud`, `exp/nbf`, `sub`.
- Se mantiene soporte de validacion `RS256` via JWKS para escenarios de federacion, pero la emision local requiere `HS256`.

## Consequences
- Menor complejidad operativa para emision local.
- Debe protegerse estrictamente `JWT_HS_SECRET` y rotarlo.
- Para multi-servicio/federado, preferible migrar emision a IdP dedicado.
